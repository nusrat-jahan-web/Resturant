import{r as b}from"./stimulus-helpers-d189GC1Y-1.js";import{E as n}from"./ez-base-controller-CGJ-YSBe-1.js";import{sendTrackingEvent as a,findCategoryByElement as _,trackCompleteEvent as M}from"./tracking-CTgR2pnh-1.js";import{aX as I,an as y,o as O,m as N,J as S,j as P,aY as F,aZ as H,a_ as q,a$ as A,b0 as w,b1 as x,b2 as R,b3 as B,b4 as U,b5 as $}from"./actions-Djic5EED-1.js";import{M as L}from"./media-matcher-vK8K0PVe-1.js";import{a as K}from"./ajax-helpers-EzPMNIcq-1.js";import{a as X}from"./js-Cz0CWeBA-1.js";import"./performance-helpers-DpsuwFL7-1.js";import"./helpers-Dn-NBgOc-1.js";import"./init-user-c_pBoS7M-1.js";import"./index-C4xxlH8f-1.js";import"./_commonjsHelpers-BosuxZz1-1.js";import"./modal_helpers-CSZX3aEY-1.js";import"https://unpkg.com/comlink/dist/esm/comlink.mjs";const o=new L,h=class h extends n{constructor(){super(...arguments),this.isVisible=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),this.trackExploreClick=e=>{a({element:e.target,data:{action:I,label:`Link-${e.target.dataset.englishLabel}`,content_type:`Content-${e.target.dataset.contentType}`}})}}connect(){this.hasMobileMenuTarget&&(this.setupSearchCloseQueries(),o.evaluateAll(),o.addListeners())}disconnect(){o.removeListeners(),o.clearQueries()}clearSearchInput(){requestAnimationFrame(()=>{this.searchField.value="",this.searchField.focus()})}hideOnClickOutside(){const e=i=>{!this.element.contains(i.target)&&this.isVisible(this.element)&&(requestAnimationFrame(()=>{document.body.classList.toggle("is-mobile-search")}),t())},t=()=>{document.removeEventListener("click",e)};setTimeout(()=>{document.addEventListener("click",e)},50)}toggleMobileSearch(){const e=document.body;requestAnimationFrame(()=>{e.classList.toggle("is-mobile-search"),e.classList.contains("is-mobile-search")?(this.hideOnClickOutside(),requestAnimationFrame(()=>{this.savedVal=this.searchField.value,this.searchField.focus(),this.searchField.value="",this.searchField.value=this.savedVal})):requestAnimationFrame(()=>{this.searchField.value="",this.searchField.value=this.savedVal})})}setupSearchCloseQueries(){o.addMediaQuery("(max-width: 635px)",null,()=>{document.querySelector(".ez-dark-overlay.mobile-search-overlay")&&this.toggleMobileSearch()})}rebuyCredits(e){a({element:e.currentTarget,data:{action:y}})}headerLogin(){a({element:this.loginButtonTarget,data:{action:O}})}headerSignUp(){a({element:this.signupButtonTarget,data:{action:N}})}sendHeaderJoinProEvent(e){const t=_(e.target);a({element:e.target,data:{action:S,category:t}}),M({action:P,category:t})}get searchField(){return this.element.querySelector(".ez-search-form__input")}};h.targets=["mobileMenu","loginButton","signupButton"];let l=h;class D extends n{constructor(){super(...arguments),this.actionsMap={bundles:F,photos:H,vectors:q,videos:A,png:w,psd:x,svg:R,editor_template:B}}trackMenuClick({target:e,params:t}){const{contentType:i}=t,s=this.getTrackingContentType(i,e);a({data:{action:this.actionsMap[s],label:"menu",category:"Header"}})}trackExploreCategoryClick({target:e,params:t}){const{category:i,contentType:s}=t,r=this.getTrackingContentType(s,e);a({data:{action:this.actionsMap[r],label:`search-${i}`,category:"Header"}})}trackExploreLinkClick({target:e,params:t}){const{linkTitle:i,contentType:s}=t,r=this.getTrackingContentType(s,e);a({data:{action:this.actionsMap[r],label:`link-${i}`,category:"Header"}})}getTrackingContentType(e,t){if(e&&Object.prototype.hasOwnProperty.call(this.actionsMap,e))return e;const i=t.closest(".ez-drop-down__title")||t.closest(".mobile-menu-group__title");return i==null?void 0:i.dataset.title}}const c=new L,g=class g extends n{constructor(){super(...arguments),this.addParentNavHover=()=>{this.hasItemNavTarget&&this.itemNavTarget.addEventListener("mouseleave",this.leavingSubmenuParent)},this.removeParentNavHover=()=>{this.hasItemNavTarget&&this.itemNavTarget.removeEventListener("mouseleave",this.leavingSubmenuParent)},this.addMenuHovers=()=>{this.itemTargets.forEach(e=>{e.addEventListener("mouseenter",this.enterMenuItem),e.addEventListener("mouseleave",this.leaveMenuItem)})},this.removeMenuHovers=()=>{this.itemTargets.forEach(e=>{e.removeEventListener("mouseenter",this.enterMenuItem),e.removeEventListener("mouseleave",this.leaveMenuItem)})},this.enterMenuItem=e=>{e.currentTarget.classList.add("is-hovered"),e.target.parentElement.classList.contains("is-hovered")?e.target.classList.contains("is-hovered")&&requestAnimationFrame(()=>{e.target.classList.add("is-active")}):setTimeout(()=>{e.target.classList.contains("is-hovered")&&requestAnimationFrame(()=>{e.target.classList.add("is-active"),e.target.parentElement.classList.add("is-hovered")})},375)},this.leaveMenuItem=e=>{requestAnimationFrame(()=>{e.target.classList.remove("is-hovered","is-active")}),e.target.querySelector(".ez-drop-down__submenu")&&this.itemNavTarget.addEventListener("mouseleave",this.leavingSubmenuParent)},this.leavingSubmenuParent=e=>{requestAnimationFrame(()=>{e.target.classList.remove("is-hovered")})}}connect(){this.setupMenuMediaQueries(),c.evaluateAll(),c.addListeners()}disconnect(){c.removeListeners(),c.clearQueries()}setupMenuMediaQueries(){c.addMediaQuery("(min-width: 801px)",()=>{this.addMenuHovers(),this.addParentNavHover()},()=>{this.removeMenuHovers(),this.removeParentNavHover()})}};g.targets=["itemNav","item"];let d=g;const v=class v extends n{constructor(){super(...arguments),this.hideMenuItems=e=>{this.menuItemTargets.forEach(t=>{t!==e&&requestAnimationFrame(()=>{t.classList.remove("is-active")})})}}connect(){new window.SiteHeaderDecorator().init({context:this.element}),window.addEventListener("CloseExploreSubMenus",this.hideMenuItems)}disconnect(){window.removeEventListener("CloseExploreSubMenus",this.hideMenuItems)}menuItemClicked(e){const t=e.currentTarget.closest(".mobile-menu-group__title");requestAnimationFrame(()=>{t.classList.contains("is-active")?document.querySelector("body").classList.remove("has-active-mobile-submenu"):document.querySelector("body").classList.add("has-active-mobile-submenu"),t.classList.toggle("is-active")}),this.hideMenuItems(t)}};v.targets=["menuItem"];let u=v;class J extends n{connect(){new window.SiteHeaderDecorator().init({context:this.element})}}const p=class p extends n{connect(){this.contentRequested=!1,this.seenCookieUpdated=!1,this.activeIds=JSON.parse(this.unseenBadgeTarget.dataset.activeNotifications),this.seenIds=JSON.parse(this.unseenBadgeTarget.dataset.seenNotifications),this.flagLoaded()}getMarketingNotifications(){this.contentRequested||(this.contentRequested=!0,K("/api/v2/marketing_notifications",e=>{this.setNotifications(e.data.marketing_notifications)},e=>{console.error(e)}))}setNotifications(e){if(this.spinnerTarget.classList.add("is-hidden"),e.length===0){this.noNotifications();return}e.forEach((t,i)=>{const s=this.marketingTemplate(t,i+1);requestAnimationFrame(()=>{this.listTarget.insertAdjacentHTML("beforeend",s)})})}noNotifications(){const e=`
      <li class="notification-item no-notifications">
        <h3>Currently no notifications</h3>
        <p>Please check back later</p>
      </li>
    `;requestAnimationFrame(()=>{this.listTarget.insertAdjacentHTML("beforeend",e)})}menuClick(e){e.currentTarget.parentNode.classList.contains("is-closed")&&(this.getMarketingNotifications(),this.seenCookieUpdated||(this.seenCookieUpdated=!0,this.updateSeenCookie()),this.sendOpenClick(e,this.activeIds.length))}updateSeenCookie(){const e=this.seenIds;if(this.activeIds){this.activeIds.forEach(i=>{e.includes(i)||e.push(i)});let t=0;for(;t<e.length&&!(e.length<=100);)this.activeIds.indexOf(e[t])===-1&&(e.splice(t,1),t-=1),t+=1;X.set("seen_notifications",JSON.stringify(e)),this.setSeenBadge()}}sendOpenClick(e,t){a({element:e.currentTarget,data:{action:U,category:"Header",value:t}})}sendCompleteEvent(e){a({element:e.currentTarget,data:{action:$,category:"Header",label:e.currentTarget.dataset.trackingLabel,value:parseInt(e.currentTarget.dataset.position,10)}})}marketingTemplate(e,t){const{id:i,title:s,url:r,new_tab:C,image:E,button_text:T}=e,k=`
      href="${r}"
      data-action="click->notifications-menu#sendCompleteEvent"
      data-tracking-label="${s}"
      data-position="${t}"
      ${C?'target="_blank"':""}
    `;return`
      <li class="notification-item marketing-notification" data-id="${i}">
        <a ${k}>
          <img src="${E.large.url}" onerror="this.remove();" />
          <h6 class="marketing-notification__title">${s}</h6>
          <button class="ez-btn ez-btn--medium marketing-notification__btn">${T}</button>
        </a>
      </li>
    `}setSeenBadge(){requestAnimationFrame(()=>{this.unseenBadgeTarget.innerHTML="",this.unseenBadgeTarget.classList.add("is-hidden")})}};p.targets=["menuButton","list","unseenBadge","spinner"];let m=p;b([["site-header",l],["menu-tracking",D],["explore-nav",d],["mobile-menu",u],["user-menu",J],["notifications-menu",m]]);
